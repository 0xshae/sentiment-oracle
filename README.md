# Sentiment Oracle

This project is a full-stack sentiment oracle system that analyzes tweets related to Solana ($SOL) and the Nifty 50 index, performs sentiment analysis, and publishes the results to the Solana blockchain.

## Module 1: Twitter Scraper

This module scrapes real tweets about `$SOL` and `Nifty 50` from various sources and saves them as structured JSON files for sentiment analysis.

### Setup

Install the required dependencies:

```
pip install -r requirements.txt
```

### Usage

Run the Twitter scraper script to collect tweets:

```
python twitter_scraper.py
```

This will:
- Attempt to scrape real tweets from multiple sources (Nitter instances, StockTwits, TradingView)
- Fall back to sample data generation if not enough real tweets are found
- Save 100 tweets for each asset as JSON files with the current date (`SOL_YYYY-MM-DD.json` and `NIFTY_YYYY-MM-DD.json`)

### Output

The script generates JSON files with the following structure for each tweet:

```json
{
    "id": "tweet_id",
    "date": "ISO 8601 timestamp",
    "username": "username",
    "content": "tweet text",
    "retweets": 0,
    "likes": 0,
    "source": "Twitter/Stocktwits/TradingView/Sample",
    "query": "original search query"
}
```

These files will be used as input for the sentiment analysis module.

## Module 2: Sentiment Analysis

This module analyzes the sentiment of tweets collected by Module 1 using a pre-trained model from HuggingFace.

### Setup

Install the required dependencies:

```
pip install -r requirements.txt
```

### Usage

Run the sentiment analysis script:

```
python sentiment_analyzer.py
```

This will:
- Load the tweet data from the JSON files generated by Module 1
- Process the tweets through a pre-trained sentiment analysis model
- Save the results to new JSON files (`SOL_sentiment_YYYY-MM-DD.json` and `NIFTY_sentiment_YYYY-MM-DD.json`)
- Display sentiment distribution statistics

### Output

The script generates JSON files with the following structure for each analyzed tweet:

```json
{
    "id": "tweet_id",
    "text": "tweet text",
    "label": "POSITIVE/NEGATIVE/NEUTRAL",
    "score": 0.9873,
    "date": "ISO 8601 timestamp",
    "username": "username",
    "source": "Twitter/Stocktwits/TradingView/Sample"
}
```

The sentiment label can be:
- `POSITIVE`: Positive sentiment, with score > 0.6
- `NEGATIVE`: Negative sentiment, with score > 0.6
- `NEUTRAL`: Uncertain sentiment, with score between 0.4 and 0.6 

## Module 3: Oracle Publisher

This module hashes, signs, and publishes the sentiment data to the Solana blockchain as verified on-chain data.

### Components

1. **Solana Program**: A smart contract that verifies and stores the signed sentiment data on-chain
2. **CLI Tool**: A Rust client for signing and submitting sentiment data to the blockchain

### Setup

Build the Solana program and CLI tool:

```bash
# Build the Solana program
cd oracle-publisher/program
cargo build-bpf

# Build the CLI tool
cd ../cli
cargo build --release
```

### Usage

1. **Deploy the Program**:
   ```bash
   solana program deploy target/deploy/sentiment_oracle_program.so
   ```

2. **Generate a Keypair**:
   ```bash
   ./target/release/sentiment-oracle-cli generate-keypair -o oracle_keypair.json
   ```

3. **Sign Sentiment Data**:
   ```bash
   ./target/release/sentiment-oracle-cli sign -i sentiment_data.json -o signed_sentiment.json
   ```

4. **Create an Account**:
   ```bash
   ./target/release/sentiment-oracle-cli create-account -t "tweet_id" -x "sample text" -u "username" -d "date" -s "source"
   ```

5. **Submit Signed Data**:
   ```bash
   ./target/release/sentiment-oracle-cli submit -i signed_sentiment.json -p <PROGRAM_ID> -a <ACCOUNT_PUBKEY>
   ```

### Output

The Solana blockchain now contains immutable records of signed sentiment data, which can be verified by anyone with access to the blockchain.

For more details, see the [Oracle Publisher README](oracle-publisher/README.md). 